<script>
  // ===== ìš”ì†Œ ë…¸ë“œ ê°€ì ¸ì˜¤ê¸° ===== //
  const $mainModalBtn = document.getElementById('open-main-modal-btn'); // ë©”ì¸ ëª¨ë‹¬ ì—´ê¸° ë²„íŠ¼
  const $mainOverlay = document.getElementById('modal-overlay-1');      // ë©”ì¸ ëª¨ë‹¬ ì˜¤ë²„ë ˆì´

  const $subModalBtn = document.getElementById('open-nested-modal-btn'); // ì¤‘ì²© ëª¨ë‹¬ ì—´ê¸° ë²„íŠ¼
  const $subOverlay = document.getElementById('modal-overlay-2');        // ì¤‘ì²© ëª¨ë‹¬ ì˜¤ë²„ë ˆì´

  const $closeButtons = [...document.querySelectorAll('.close-btn')];   // ëª¨ë“  ë‹«ê¸° ë²„íŠ¼ (NodeList â†’ ë°°ì—´ë¡œ ë³€í™˜)

  // ===== ê³µí†µ ë™ì‘ í•¨ìˆ˜ ì •ì˜ ===== //

  // ğŸ‘‰ ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜: ì˜¤ë²„ë ˆì´ë¥¼ flexë¡œ ë³´ì—¬ì£¼ê³  body ìŠ¤í¬ë¡¤ ë§‰ê¸°
  function openModal($modalOverlay) {
    $modalOverlay.style.display = 'flex';
    document.body.classList.add('modal-open'); // bodyì— í´ë˜ìŠ¤ ì¶”ê°€í•´ì„œ ìŠ¤í¬ë¡¤ ì œê±°
  }

  // ğŸ‘‰ ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜: ì˜¤ë²„ë ˆì´ë¥¼ ë‹¤ì‹œ ì•ˆ ë³´ì´ê²Œ í•¨
  function closeModal($modalOverlay) {
    $modalOverlay.style.display = 'none';

    // consoleë¡œ ì–´ë–¤ ëª¨ë‹¬ì´ ë‹«íˆëŠ”ì§€ í™•ì¸ìš©
    console.log($modalOverlay);

    // ë©”ì¸ ëª¨ë‹¬ì´ ë‹«í ë•Œë§Œ ìŠ¤í¬ë¡¤ ë‹¤ì‹œ í—ˆìš©
    if ($modalOverlay === $mainOverlay) {
      document.body.classList.remove('modal-open');
    }
  }

  // ===== ì´ë²¤íŠ¸ ë°”ì¸ë”© ===== //

  // âœ… ë©”ì¸ ëª¨ë‹¬ ì—´ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ
  $mainModalBtn.addEventListener('click', e => {
    openModal($mainOverlay);
  });

  // âœ… ì¤‘ì²© ëª¨ë‹¬ ì—´ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ
  $subModalBtn.addEventListener('click', e => {
    openModal($subOverlay);
  });

  // âœ… ëª¨ë“  ë‹«ê¸° ë²„íŠ¼ì— ì´ë²¤íŠ¸ ì—°ê²°
  $closeButtons.forEach($closeBtn => {
    $closeBtn.addEventListener('click', e => {
      // data-modal-id ì†ì„±ìœ¼ë¡œ ì–´ë–¤ ëª¨ë‹¬ì„ ë‹«ì„ì§€ ì°¾ìŒ
      const $targetModal = document.getElementById($closeBtn.dataset.modalId);
      closeModal($targetModal);
    });
  });

  // âœ… ê²€ì • ë°°ê²½ í´ë¦­í•˜ë©´ ëª¨ë‹¬ ë‹«ê¸°
  $mainOverlay.addEventListener('click', e => {
    // ì˜¤ë²„ë ˆì´(ë°”ê¹¥ ì˜ì—­)ë§Œ í´ë¦­í•œ ê²½ìš°ì—ë§Œ ë‹«í˜
    if (e.target === $mainOverlay) {
      closeModal($mainOverlay);
    }
  });

  $subOverlay.addEventListener('click', e => {
    if (e.target === $subOverlay) {
      closeModal($subOverlay);
    }
  });

  // âœ… ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
      // ì¤‘ì²© ëª¨ë‹¬ì´ ì—´ë ¤ìˆìœ¼ë©´ ì¤‘ì²© ëª¨ë‹¬ë¶€í„° ë‹«ê³ 
      if ($subOverlay.style.display === 'flex') {
        closeModal($subOverlay);
      }
      // ì¤‘ì²© ëª¨ë‹¬ì´ ì•ˆ ì—´ë ¤ ìˆìœ¼ë©´ ë©”ì¸ ëª¨ë‹¬ ë‹«ê¸°
      else if ($mainOverlay.style.display === 'flex') {
        closeModal($mainOverlay);
      }
    }
  });
</script>
